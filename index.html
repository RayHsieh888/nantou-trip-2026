<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>2025.12.25 南投深度慢旅 (含即時翻譯)</title>
    <!-- 引入 Google 字體與 Icon -->
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@300;400;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <style>
        :root {
            --primary-color: #8b0000; /* 深紅色 */
            --secondary-color: #a52a2a; /* 棕紅色 */
            --accent-color: #d35400; /* 橘色點綴 */
            --bg-color: #fffaf0;
            --card-bg: #ffffff;
            --text-color: #2c3e50;
        }

        body {
            font-family: 'Noto Sans TC', sans-serif;
            background-color: var(--bg-color);
            color: var(--text-color);
            line-height: 1.6;
            margin: 0;
            padding: 0;
            padding-bottom: 50px;
        }

        .container {
            max-width: 600px;
            margin: 0 auto;
            padding: 20px;
        }

        header {
            text-align: center;
            padding: 40px 20px;
            background: linear-gradient(rgba(139,0,0,0.8), rgba(139,0,0,0.8)), url('https://images.unsplash.com/photo-1518173946687-a4c8a9833d8e?auto=format&fit=crop&w=800&q=80');
            background-size: cover;
            background-position: center;
            color: white;
            border-radius: 0 0 30px 30px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.2);
        }

        .date-badge {
            background: #fff;
            color: var(--primary-color);
            padding: 5px 15px;
            border-radius: 20px;
            font-size: 0.9rem;
            font-weight: bold;
        }

        /* 翻譯工具樣式 */
        .tool-section {
            background: var(--card-bg);
            border-radius: 20px;
            padding: 25px;
            margin-top: 30px;
            box-shadow: 0 10px 25px rgba(0,0,0,0.1);
            border: 2px solid var(--primary-color);
        }

        .tool-title {
            color: var(--primary-color);
            font-size: 1.4rem;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .lang-switch {
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            padding: 10px;
            border-radius: 50px;
            margin-bottom: 20px;
            gap: 15px;
            cursor: pointer;
            transition: 0.3s;
        }

        .lang-switch:active { transform: scale(0.98); }
        .lang-label { font-weight: bold; color: var(--secondary-color); }

        .input-group {
            position: relative;
            margin-bottom: 15px;
        }

        textarea {
            width: 100%;
            border: 1px solid #ddd;
            border-radius: 12px;
            padding: 15px;
            box-sizing: border-box;
            font-size: 1rem;
            min-height: 100px;
            resize: none;
            font-family: inherit;
        }

        .mic-btn {
            position: absolute;
            right: 10px;
            bottom: 10px;
            background: var(--primary-color);
            color: white;
            border: none;
            width: 45px;
            height: 45px;
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            box-shadow: 0 4px 10px rgba(0,0,0,0.2);
        }

        .mic-btn.recording {
            background: #e74c3c;
            animation: pulse 1.5s infinite;
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.1); }
            100% { transform: scale(1); }
        }

        .action-btns {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
        }

        .btn {
            padding: 12px;
            border-radius: 10px;
            border: none;
            cursor: pointer;
            font-weight: bold;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
            transition: 0.3s;
        }

        .btn-translate { background: var(--primary-color); color: white; width: 100%; margin-bottom: 10px; }
        .btn-clear { background: #eee; color: #666; }
        .btn-speak { background: var(--secondary-color); color: white; }

        .result-box {
            background: #fff8f8;
            border-left: 4px solid var(--primary-color);
            padding: 15px;
            margin-top: 15px;
            border-radius: 8px;
            min-height: 50px;
        }

        .result-text { font-size: 1.1rem; color: #333; margin-bottom: 10px; }

        /* 行程表樣式調整為深紅 */
        .timeline { position: relative; margin: 30px 0; padding-left: 20px; }
        .timeline::before { content: ''; position: absolute; left: 5px; top: 5px; bottom: 5px; width: 2px; background: var(--primary-color); opacity: 0.3; }
        .event-card {
            background: var(--card-bg);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 25px;
            position: relative;
            box-shadow: 0 4px 6px rgba(0,0,0,0.05);
            border-left: 5px solid var(--primary-color);
        }
        .time { font-weight: 700; color: var(--primary-color); display: block; margin-bottom: 5px; }
        .btn-nav {
            display: flex; align-items: center; justify-content: center;
            background: var(--primary-color); color: white; text-decoration: none;
            padding: 10px; border-radius: 8px; margin-top: 15px; font-weight: bold;
        }
        footer { text-align: center; padding: 40px; color: #888; }
    </style>
</head>
<body>

<header>
    <div class="date-badge">2025.12.25 THU</div>
    <h1>南投深度慢旅</h1>
    <div class="subtitle">最終行程確認單</div>
</header>

<div class="container">
    
    <!-- 翻譯助理區塊 -->
    <section class="tool-section">
        <div class="tool-title"><i class="fas fa-language"></i> 隨身翻譯官</div>
        
        <div class="lang-switch" onclick="toggleLanguage()">
            <span class="lang-label" id="langFromText">繁體中文</span>
            <i class="fas fa-exchange-alt" style="color:#999"></i>
            <span class="lang-label" id="langToText">英文 (English)</span>
        </div>

        <div class="input-group">
            <textarea id="inputText" placeholder="請輸入文字或點擊右下角麥克風說話..."></textarea>
            <button class="mic-btn" id="micBtn" onclick="startSpeechRecognition()">
                <i class="fas fa-microphone"></i>
            </button>
        </div>

        <button class="btn btn-translate" onclick="performTranslation()">
            <i class="fas fa-magic"></i> 開始翻譯
        </button>

        <div class="result-box" id="resultArea" style="display:none;">
            <div class="result-text" id="outputText">...</div>
            <div class="action-btns">
                <button class="btn btn-clear" onclick="clearAll()"><i class="fas fa-trash"></i> 清除</button>
                <button class="btn btn-speak" onclick="speakResult()"><i class="fas fa-volume-up"></i> 朗讀結果</button>
            </div>
        </div>
    </section>

    <!-- 原有行程區塊 (色調更新) -->
    <div class="timeline">
        <div class="event-card">
            <span class="time">07:00 桃園出發</span>
            <h3><i class="fas fa-car"></i> 避開龍潭車潮</h3>
            <p>務必 7 點前上國道三號。</p>
        </div>

        <div class="event-card">
            <span class="time">09:00 - 11:30</span>
            <h3><i class="fas fa-map-marker-alt"></i> 集元果觀光工廠</h3>
            <p>香蕉生態園區、森林餐廳。南投縣集集鎮大坪巷38號。</p>
            <a href="https://www.google.com/maps/search/?api=1&query=集元果觀光工廠" class="btn-nav">開啟導航</a>
        </div>

        <div class="event-card">
            <span class="time">12:00 - 13:00</span>
            <h3><i class="fas fa-utensils"></i> 榕樹下扣仔嗲</h3>
            <p>必吃：現炸蚵嗲、肉嗲。請停「仁愛公園停車場」。</p>
            <a href="https://www.google.com/maps/search/?api=1&query=草屯仁愛公園停車場" class="btn-nav">導航至停車場</a>
        </div>

        <div class="event-card">
            <span class="time">13:15 - 14:00</span>
            <h3><i class="fas fa-coffee"></i> 九二咖啡故事館</h3>
            <p>國道六號旁，舊穀倉咖啡。14:00 準時北返。</p>
            <a href="https://www.google.com/maps/search/?api=1&query=九二咖啡故事館" class="btn-nav">開啟導航</a>
        </div>
    </div>
</div>

<footer>
    &copy; 2025 南投慢旅計畫 | 祝旅途愉快
</footer>

<script>
    // 翻譯狀態設定
    let currentMode = 'zh-en'; // zh-en 或 en-zh
    const recognition = window.SpeechRecognition || window.webkitSpeechRecognition ? new (window.SpeechRecognition || window.webkitSpeechRecognition)() : null;
    
    if (recognition) {
        recognition.continuous = false;
        recognition.interimResults = false;
        
        recognition.onresult = (event) => {
            const text = event.results[0][0].transcript;
            document.getElementById('inputText').value = text;
            stopMicStyle();
            performTranslation(); // 語音辨識完自動翻譯
        };

        recognition.onerror = () => stopMicStyle();
        recognition.onend = () => stopMicStyle();
    }

    // 切換語言模式
    function toggleLanguage() {
        if (currentMode === 'zh-en') {
            currentMode = 'en-zh';
            document.getElementById('langFromText').innerText = '英文 (English)';
            document.getElementById('langToText').innerText = '繁體中文';
            document.getElementById('inputText').placeholder = 'Type here or tap mic to speak...';
        } else {
            currentMode = 'zh-en';
            document.getElementById('langFromText').innerText = '繁體中文';
            document.getElementById('langToText').innerText = '英文 (English)';
            document.getElementById('inputText').placeholder = '請輸入文字或點擊右下角麥克風說話...';
        }
    }

    // 語音辨識
    function startSpeechRecognition() {
        if (!recognition) {
            alert("您的瀏覽器不支援語音辨識功能。");
            return;
        }
        recognition.lang = currentMode === 'zh-en' ? 'zh-TW' : 'en-US';
        recognition.start();
        document.getElementById('micBtn').classList.add('recording');
    }

    function stopMicStyle() {
        document.getElementById('micBtn').classList.remove('recording');
    }

    // 呼叫翻譯 API (MyMemory)
    async function performTranslation() {
        const text = document.getElementById('inputText').value.trim();
        if (!text) return;

        const outputArea = document.getElementById('resultArea');
        const outputText = document.getElementById('outputText');
        
        outputText.innerText = "翻譯中...";
        outputArea.style.display = 'block';

        const langPair = currentMode === 'zh-en' ? 'zh-TW|en' : 'en|zh-TW';
        const url = `https://api.mymemory.translated.net/get?q=${encodeURIComponent(text)}&langpair=${langPair}`;

        try {
            const response = await fetch(url);
            const data = await response.json();
            if (data.responseData) {
                outputText.innerText = data.responseData.translatedText;
            } else {
                outputText.innerText = "翻譯失敗，請稍後再試。";
            }
        } catch (error) {
            outputText.innerText = "網路錯誤或 API 限制。";
        }
    }

    // 語音合成 (TTS)
    function speakResult() {
        const text = document.getElementById('outputText').innerText;
        const msg = new SpeechSynthesisUtterance();
        msg.text = text;
        msg.lang = currentMode === 'zh-en' ? 'en-US' : 'zh-TW';
        window.speechSynthesis.speak(msg);
    }

    function clearAll() {
        document.getElementById('inputText').value = '';
        document.getElementById('resultArea').style.display = 'none';
    }
</script>

</body>
</html>
